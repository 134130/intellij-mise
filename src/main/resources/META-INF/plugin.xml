<!-- Plugin Configuration File. Read more: https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin url="https://github.com/l34130/intellij-mise" require-restart="false">
    <id>com.github.l34130.mise</id>
    <name>Mise</name>
    <vendor>134130</vendor>

    <depends>com.intellij.modules.platform</depends>
    <depends>org.toml.lang</depends>

    <!-- Language Support -->
    <extensions defaultExtensionNs="com.intellij">
        <fileType name="mise"
                  language="MiseToml"
                  implementationClass="com.github.l34130.mise.core.lang.MiseTomlFileType"
                  fieldName="INSTANCE"
                  patterns=".mise.toml;.mise.*.toml;mise.toml;mise.*.toml;**/.mise/config.toml;**/mise/config.toml"
        />

        <lang.parserDefinition
                language="MiseToml"
                implementationClass="com.github.l34130.mise.core.lang.psi.MiseTomlParserDefinition"/>

        <psi.referenceContributor
                order="first" language="TOML" id="MiseToml"
                implementation="com.github.l34130.mise.core.lang.resolve.MiseTomlReferenceContributor"/>
        <completion.contributor
                order="first" language="TOML" id="MiseToml"
                implementationClass="com.github.l34130.mise.core.lang.completion.MiseTomlCompletionContributor"/>
        <json.jsonLikePsiWalkerFactory implementation="com.github.l34130.mise.core.lang.json.MiseTomlPsiWalkerFactory"/>
    </extensions>
    <extensions defaultExtensionNs="JavaScript">
        <JsonSchema.ProviderFactory order="first" implementation="com.github.l34130.mise.core.lang.json.MiseTomlJsonSchemaFileProviderFactory"/>
    </extensions>

    <extensions defaultExtensionNs="com.intellij">
        <projectConfigurable id="com.github.l34130.mise.core.setting.MiseConfigurable"
                             instance="com.github.l34130.mise.core.setting.MiseConfigurable"
                             groupId="tools"
                             displayName="Mise Settings"/>

        <toolWindow id="Mise"
                    secondary="true"
                    icon="com.github.l34130.mise.core.icon.MiseIcons.DEFAULT"
                    anchor="right"
                    factoryClass="com.github.l34130.mise.core.toolwindow.MiseTreeToolWindowFactory"/>

        <notificationGroup id="Mise" displayType="BALLOON" toolWindowId="Mise"/>

        <errorHandler implementation="com.github.l34130.mise.core.MiseErrorReportSubmitter"/>
    </extensions>

    <actions>
        <group id="com.github.l34130.mise.actions"
               text="Mise: Reload Dev Tools"
               popup="true"
               description="Reload Mise devtools"
               icon="com.github.l34130.mise.core.icon.MiseIcons.DEFAULT">
            <add-to-group group-id="ToolsMenu"/>
        </group>
    </actions>

    <depends optional="true" config-file="mise-goland.xml">org.jetbrains.plugins.go</depends>
    <depends optional="true" config-file="mise-gradle.xml">com.intellij.gradle</depends>
    <depends optional="true" config-file="mise-idea.xml">com.intellij.java</depends>
    <depends optional="true" config-file="mise-javascript.xml">JavaScript</depends>
    <depends optional="true" config-file="mise-rider.xml">com.intellij.modules.rider</depends>
</idea-plugin>
